<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Kripto piyasa haberleri - Bitcoin, Ethereum, Altcoin ve DeFi son dakika haberleri.">
    <title>Canlı Haberler | Only a Trader</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
:root {
    --bg-primary: #050507;
    --bg-secondary: #0a0a0f;
    --bg-surface: #0f0f16;
    --bg-card: #12121c;
    --bg-card-hover: #161622;
    --bg-elevated: #1a1a28;
    --text-primary: #e8e8ed;
    --text-secondary: #8888a0;
    --text-muted: #55556a;
    --accent-blue: #2563eb;
    --accent-blue-dim: rgba(37, 99, 235, 0.15);
    --accent-gold: #c9a227;
    --accent-red: #ea3943;
    --accent-green: #10b981;
    --border-color: rgba(255, 255, 255, 0.06);
    --border-hover: rgba(255, 255, 255, 0.12);
    --font-main: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
    --radius-sm: 6px;
    --radius-md: 10px;
    --radius-lg: 16px;
    --shadow-md: 0 4px 24px rgba(0, 0, 0, 0.4);
    --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }
body { font-family: var(--font-main); background: var(--bg-primary); color: var(--text-primary); line-height: 1.7; overflow-x: hidden; }
a { text-decoration: none; color: inherit; transition: color var(--transition); }

.container { max-width: 1280px; margin: 0 auto; padding: 0 24px; }

/* NAV */
.navbar {
    position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
    padding: 16px 0;
    background: rgba(5, 5, 7, 0.85);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border-color);
}
.nav-container { display: flex; align-items: center; justify-content: space-between; }
.nav-right { display: flex; align-items: center; gap: 24px; }
.back-link {
    display: inline-flex; align-items: center; gap: 6px;
    font-size: 0.82rem; color: var(--text-muted);
    padding: 6px 14px; border-radius: var(--radius-sm);
    border: 1px solid var(--border-color);
    transition: all var(--transition);
}
.back-link:hover { color: var(--text-primary); border-color: var(--border-hover); }
.back-link svg { width: 16px; height: 16px; }

/* PAGE HEADER */
.page-header {
    padding: 120px 0 32px;
    text-align: center;
}
.page-header h1 {
    font-size: 2.2rem; font-weight: 700;
    letter-spacing: -0.02em; margin-bottom: 8px;
}
.page-header h1 span { color: var(--accent-blue); }
.page-subtitle {
    color: var(--text-muted); font-size: 0.9rem;
    display: flex; align-items: center; justify-content: center; gap: 8px;
}
.live-dot {
    display: inline-block; width: 8px; height: 8px;
    background: #16c784; border-radius: 50%;
    animation: pulse 2s infinite;
}
@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
}

/* CATEGORY FILTERS */
.category-filters {
    display: flex; gap: 8px; flex-wrap: wrap;
    justify-content: center;
    padding: 24px 0 32px;
}
.cat-btn {
    padding: 8px 18px; border-radius: 20px;
    font-size: 0.8rem; font-weight: 500;
    color: var(--text-muted); cursor: pointer;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    font-family: inherit;
    transition: all var(--transition);
}
.cat-btn:hover { color: var(--text-primary); border-color: var(--border-hover); }
.cat-btn.active {
    color: #fff; background: var(--accent-blue);
    border-color: var(--accent-blue);
}

/* BREAKING NEWS */
.breaking-section { margin-bottom: 32px; }
.breaking-grid {
    display: grid;
    grid-template-columns: 1.2fr 1fr;
    gap: 14px;
}
.breaking-card {
    position: relative; border-radius: var(--radius-lg);
    overflow: hidden; background: var(--bg-card);
    border: 1px solid var(--border-color);
    transition: all var(--transition);
    display: flex; flex-direction: column;
}
.breaking-card:hover { border-color: var(--border-hover); transform: translateY(-2px); }
.breaking-card a { display: flex; flex-direction: column; height: 100%; }
.breaking-img {
    width: 100%; height: 160px;
    object-fit: cover; display: block;
}
.breaking-card:first-child .breaking-img { height: 200px; }
.breaking-content { padding: 14px; flex: 1; display: flex; flex-direction: column; }
.breaking-badge {
    display: inline-flex; align-items: center; gap: 4px;
    padding: 4px 10px; border-radius: 4px;
    font-size: 0.68rem; font-weight: 700;
    text-transform: uppercase; letter-spacing: 0.5px;
    background: rgba(234, 57, 67, 0.15); color: var(--accent-red);
    width: fit-content; margin-bottom: 10px;
}
.breaking-badge .dot {
    width: 6px; height: 6px; border-radius: 50%;
    background: var(--accent-red); animation: pulse 1.5s infinite;
}
.breaking-title {
    font-size: 1rem; font-weight: 700; line-height: 1.35;
    color: var(--text-primary); margin-bottom: 8px;
}
.breaking-card:first-child .breaking-title { font-size: 1.15rem; }
.breaking-excerpt {
    font-size: 0.8rem; color: var(--text-secondary);
    line-height: 1.5; margin-bottom: 8px;
    display: -webkit-box; -webkit-line-clamp: 2;
    -webkit-box-orient: vertical; overflow: hidden;
}

/* NEWS GRID */
.news-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 14px;
    margin-bottom: 40px;
}
.news-card {
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-lg);
    overflow: hidden;
    transition: all var(--transition);
    display: flex; flex-direction: column;
}
.news-card:hover { border-color: var(--border-hover); transform: translateY(-2px); }
.news-card a { display: flex; flex-direction: column; height: 100%; }
.news-img {
    width: 100%; height: 120px;
    object-fit: cover; display: block;
    background: var(--bg-elevated);
}
.news-content {
    padding: 12px 14px; flex: 1;
    display: flex; flex-direction: column;
}
.news-meta {
    display: flex; align-items: center; gap: 6px;
    margin-bottom: 6px; flex-wrap: wrap;
}
.news-source {
    font-size: 0.72rem; font-weight: 600;
    color: var(--accent-blue);
    text-transform: uppercase; letter-spacing: 0.5px;
}
.news-time {
    font-size: 0.72rem; color: var(--text-muted);
    font-family: var(--font-mono);
}
.news-meta-dot {
    width: 3px; height: 3px; border-radius: 50%;
    background: var(--text-muted);
}
.news-title {
    font-size: 0.82rem; font-weight: 600;
    line-height: 1.4; color: var(--text-primary);
    margin-bottom: 6px;
    display: -webkit-box; -webkit-line-clamp: 2;
    -webkit-box-orient: vertical; overflow: hidden;
}
.news-tags {
    display: flex; gap: 4px; flex-wrap: wrap;
    margin-top: auto; padding-top: 8px;
}
.news-tag {
    padding: 3px 8px; border-radius: 4px;
    font-size: 0.65rem; font-weight: 500;
    background: rgba(255, 255, 255, 0.04);
    color: var(--text-muted);
    text-transform: uppercase; letter-spacing: 0.5px;
}
.news-tag.btc { background: rgba(247, 147, 26, 0.12); color: #f7931a; }
.news-tag.eth { background: rgba(98, 126, 234, 0.12); color: #627eea; }
.news-tag.defi { background: rgba(201, 162, 39, 0.12); color: #c9a227; }
.news-tag.regulation { background: rgba(234, 57, 67, 0.12); color: #ea3943; }
.news-tag.trading { background: rgba(37, 99, 235, 0.12); color: #2563eb; }

/* LOADING & STATES */
.loading-spinner {
    text-align: center; padding: 60px 0;
    color: var(--text-muted); font-size: 0.9rem;
}
.spinner-ring {
    display: inline-block; width: 28px; height: 28px;
    border: 2px solid var(--border-color);
    border-top-color: var(--accent-blue);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin-bottom: 12px;
}
@keyframes spin { to { transform: rotate(360deg); } }

.load-more-wrap { text-align: center; padding: 20px 0 60px; }
.load-more-btn {
    padding: 12px 32px; border-radius: var(--radius-md);
    font-size: 0.85rem; font-weight: 600;
    color: var(--text-primary); cursor: pointer;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    font-family: inherit;
    transition: all var(--transition);
}
.load-more-btn:hover { border-color: var(--accent-blue); color: var(--accent-blue); }
.load-more-btn:disabled { opacity: 0.4; cursor: not-allowed; }

.error-msg {
    text-align: center; padding: 40px;
    color: var(--text-muted); font-size: 0.9rem;
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-lg);
}

/* FOOTER */
.footer {
    margin-top: 20px; padding: 32px 0;
    border-top: 1px solid var(--border-color);
    text-align: center;
}
.footer p { font-size: 0.78rem; color: var(--text-muted); }
.footer a { color: var(--accent-blue); }

/* RESPONSIVE */
@media (max-width: 1024px) {
    .news-grid { grid-template-columns: repeat(2, 1fr); }
}

@media (max-width: 768px) {
    .breaking-grid { grid-template-columns: 1fr; }
    .breaking-img, .breaking-card:first-child .breaking-img { height: 160px; }
    .news-grid { grid-template-columns: 1fr; }
    .page-header h1 { font-size: 1.6rem; }
    .breaking-card:first-child .breaking-title { font-size: 1.15rem; }
    .category-filters { gap: 6px; }
    .cat-btn { padding: 6px 14px; font-size: 0.75rem; }
}

@media (max-width: 480px) {
    .container { padding: 0 16px; }
    .news-content { padding: 14px; }
    .breaking-content { padding: 16px; }
}
    </style>
</head>
<body>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-container">
            <a href="onlyatrader.html" class="nav-logo">
                <svg viewBox="0 0 280 36" fill="none" xmlns="http://www.w3.org/2000/svg" style="height:32px;width:auto;">
                    <defs>
                        <linearGradient id="tg" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#fff"/><stop offset="100%" style="stop-color:#c8c8d0"/></linearGradient>
                        <linearGradient id="ag" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#2563eb"/><stop offset="100%" style="stop-color:#3b82f6"/></linearGradient>
                        <clipPath id="cL"><rect x="0" y="0" width="13" height="36"/><rect x="13" y="16" width="24" height="20"/></clipPath>
                        <clipPath id="cR"><rect x="21" y="0" width="16" height="36"/><rect x="0" y="0" width="21" height="16"/></clipPath>
                    </defs>
                    <rect clip-path="url(#cL)" x="1" y="10" width="20" height="12" rx="6" stroke="url(#ag)" stroke-width="2" fill="none"/>
                    <rect clip-path="url(#cR)" x="13" y="10" width="20" height="12" rx="6" stroke="url(#ag)" stroke-width="2" fill="none"/>
                    <text x="40" y="24" font-family="Inter, sans-serif" font-size="18" font-weight="700" letter-spacing="3" fill="url(#tg)">ONLY A TRADER</text>
                </svg>
            </a>
            <div class="nav-right">
                <a href="onlyatrader.html" class="back-link">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5"/><path d="M12 19l-7-7 7-7"/></svg>
                    Ana Sayfa
                </a>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <div class="page-header">
        <div class="container">
            <h1>Canlı <span>Haberler</span></h1>
            <p class="page-subtitle"><span class="live-dot"></span>Küresel finans ve kripto piyasa haberleri anlık güncellenmektedir</p>
        </div>
    </div>

    <main>
        <div class="container">

            <!-- Category Filters -->
            <div class="category-filters" id="categoryFilters">
                <button class="cat-btn active" data-cat="">Tümü</button>
                <button class="cat-btn" data-cat="bitcoin">Bitcoin</button>
                <button class="cat-btn" data-cat="altcoin">Altcoin</button>
                <button class="cat-btn" data-cat="emtia">Emtia</button>
                <button class="cat-btn" data-cat="endeks">Endeksler</button>
                <button class="cat-btn" data-cat="forex">Forex</button>
                <button class="cat-btn" data-cat="ekonomi">Ekonomi</button>
                <button class="cat-btn" data-cat="regulasyon">Regülasyon</button>
            </div>

            <!-- Breaking News -->
            <div class="breaking-section" id="breakingSection"></div>

            <!-- News Grid -->
            <div class="news-grid" id="newsGrid"></div>

            <!-- Loading -->
            <div class="loading-spinner" id="loadingSpinner">
                <div class="spinner-ring"></div>
                <div>Haberler yükleniyor...</div>
            </div>

            <!-- Load More -->
            <div class="load-more-wrap" id="loadMoreWrap" style="display:none">
                <button class="load-more-btn" id="loadMoreBtn">Daha Fazla Haber Yükle</button>
            </div>

        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 <a href="onlyatrader.html">Only a Trader</a>. Türkçe finans haber kaynakları. Finansal tavsiye verilmez.</p>
        </div>
    </footer>

    <script>
const NewsFeed = {
    allNews: [],
    displayedCount: 0,
    pageSize: 12,
    activeCategory: '',

    // Türkçe finans ve kripto haber kaynakları
    trSources: [
        { name: 'Koin Bülteni', rss: 'https://koinbulteni.com/feed' },
        { name: 'CoinTürk', rss: 'https://coin-turk.com/feed' },
        { name: 'BeInCrypto TR', rss: 'https://tr.beincrypto.com/feed/' },
        { name: 'Bloomberg HT', rss: 'https://www.bloomberght.com/rss' },
        { name: 'Para Analiz', rss: 'https://www.paraanaliz.com/feed/' },
        { name: 'Ekonomim', rss: 'https://www.ekonomim.com/rss' },
        { name: 'BtcHaber', rss: 'https://www.btchaber.com/feed/' }
    ],

    // Yedek: İngilizce kaynaklar
    enSources: [
        { name: 'CoinTelegraph', rss: 'https://cointelegraph.com/rss' },
        { name: 'CoinDesk', rss: 'https://www.coindesk.com/arc/outboundfeeds/rss/' },
        { name: 'Investing.com', rss: 'https://tr.investing.com/rss/news.rss' }
    ],

    init() {
        this.setupFilters();
        this.setupLoadMore();
        this.fetchNews();
        setInterval(() => this.fetchNews(), 180000);
    },

    async fetchNews() {
        this.showLoading(true);
        const allItems = [];

        // Önce Türkçe kaynaklardan çek
        const trItems = await this.fetchRSS(this.trSources);
        allItems.push(...trItems);

        // Türkçe az geldiyse İngilizce kaynaklardan da ekle
        if (allItems.length < 10) {
            const enItems = await this.fetchRSS(this.enSources);
            allItems.push(...enItems);
        }

        // CryptoCompare'den de dene (Türkçe destekliyorsa TR, yoksa EN)
        const ccItems = await this.fetchCryptoCompare();
        if (ccItems) allItems.push(...ccItems);

        // Tekrar edenleri kaldır (başlık bazlı)
        const seen = new Set();
        const unique = allItems.filter(item => {
            const key = item.title.substring(0, 60).toLowerCase();
            if (seen.has(key)) return false;
            seen.add(key);
            return true;
        });

        unique.sort((a, b) => b.time - a.time);

        if (unique.length > 0) {
            this.allNews = unique;
            this.displayedCount = 0;
            this.render();
        } else {
            this.showError();
        }
        this.showLoading(false);
    },

    async fetchCryptoCompare() {
        for (const lang of ['TR', 'EN']) {
            try {
                const res = await fetch('https://min-api.cryptocompare.com/data/v2/news/?lang=' + lang + '&sortOrder=latest');
                if (!res.ok) continue;
                const json = await res.json();
                if (!json.Data || json.Data.length === 0) continue;
                return json.Data.map(item => ({
                    id: 'cc-' + item.id,
                    title: item.title,
                    body: (item.body || '').substring(0, 200),
                    url: item.url,
                    image: item.imageurl,
                    source: item.source_info?.name || item.source || 'CryptoCompare',
                    time: item.published_on * 1000,
                    categories: this.classifyText(item.title + ' ' + (item.categories || '') + ' ' + (item.tags || '')),
                    tags: []
                }));
            } catch (e) { /* silent */ }
        }
        return null;
    },

    async fetchRSS(sources) {
        const allItems = [];
        const proxy = 'https://api.rss2json.com/v1/api.json?rss_url=';
        const fetches = sources.map(async (src) => {
            try {
                const res = await fetch(proxy + encodeURIComponent(src.rss));
                if (!res.ok) return;
                const json = await res.json();
                if (json.items) {
                    json.items.forEach(item => {
                        allItems.push({
                            id: item.guid || item.link,
                            title: item.title,
                            body: this.stripHTML(item.description || '').substring(0, 200),
                            url: item.link,
                            image: item.thumbnail || item.enclosure?.link || '',
                            source: src.name,
                            time: new Date(item.pubDate).getTime(),
                            categories: this.classifyText(item.title + ' ' + (item.description || '')),
                            tags: []
                        });
                    });
                }
            } catch (e) { /* silent */ }
        });
        await Promise.allSettled(fetches);
        return allItems;
    },

    classifyText(text) {
        const cats = [];
        const t = text.toLowerCase();
        // Bitcoin
        if (t.includes('bitcoin') || t.includes('btc') || t.includes('satoshi')) cats.push('bitcoin');
        // Altcoin
        if (t.includes('ethereum') || t.includes('eth') || t.includes('altcoin') || t.includes('solana') ||
            t.includes('xrp') || t.includes('cardano') || t.includes('bnb') || t.includes('avalanche') ||
            t.includes('polkadot') || t.includes('dogecoin') || t.includes('shiba') || t.includes('kripto') ||
            t.includes('crypto') || t.includes('defi') || t.includes('nft') || t.includes('blockchain') ||
            t.includes('token') || t.includes('coin') || t.includes('mining') || t.includes('madencilik')) cats.push('altcoin');
        // Emtia
        if (t.includes('altın') || t.includes('gold') || t.includes('gümüş') || t.includes('silver') ||
            t.includes('petrol') || t.includes('oil') || t.includes('emtia') || t.includes('commodity') ||
            t.includes('bakır') || t.includes('copper') || t.includes('doğalgaz') || t.includes('natural gas')) cats.push('emtia');
        // Endeksler
        if (t.includes('s&p') || t.includes('nasdaq') || t.includes('dow jones') || t.includes('endeks') ||
            t.includes('bist') || t.includes('borsa istanbul') || t.includes('dax') || t.includes('ftse') ||
            t.includes('nikkei') || t.includes('hisse') || t.includes('stock') || t.includes('wall street')) cats.push('endeks');
        // Forex
        if (t.includes('dolar') || t.includes('dollar') || t.includes('euro') || t.includes('eur/usd') ||
            t.includes('forex') || t.includes('kur') || t.includes('döviz') || t.includes('tl') ||
            t.includes('yen') || t.includes('sterlin') || t.includes('gbp')) cats.push('forex');
        // Ekonomi
        if (t.includes('faiz') || t.includes('enflasyon') || t.includes('inflation') || t.includes('fed') ||
            t.includes('merkez bankası') || t.includes('central bank') || t.includes('tcmb') || t.includes('ecb') ||
            t.includes('gdp') || t.includes('gsyh') || t.includes('istihdam') || t.includes('employment') ||
            t.includes('resesyon') || t.includes('recession') || t.includes('ekonomi') || t.includes('economy')) cats.push('ekonomi');
        // Regülasyon
        if (t.includes('regülasyon') || t.includes('regulation') || t.includes('sec') || t.includes('spk') ||
            t.includes('yasa') || t.includes('law') || t.includes('düzenleme') || t.includes('ban') ||
            t.includes('yasakla') || t.includes('lisans') || t.includes('license')) cats.push('regulasyon');
        return cats;
    },

    stripHTML(str) {
        const tmp = document.createElement('div');
        tmp.innerHTML = str;
        return tmp.textContent || tmp.innerText || '';
    },

    // ── Filtering ──
    getFiltered() {
        if (!this.activeCategory) return this.allNews;
        return this.allNews.filter(n =>
            n.categories.some(c => c.toUpperCase() === this.activeCategory.toUpperCase())
        );
    },

    // ── Rendering ──
    render() {
        const filtered = this.getFiltered();
        const breakingEl = document.getElementById('breakingSection');
        const gridEl = document.getElementById('newsGrid');
        const loadWrap = document.getElementById('loadMoreWrap');

        if (filtered.length === 0) {
            breakingEl.innerHTML = '';
            gridEl.innerHTML = '<div class="error-msg">Bu kategoride haber bulunamadı.</div>';
            loadWrap.style.display = 'none';
            return;
        }

        // Breaking: first 2 items
        const breaking = filtered.slice(0, 2);
        breakingEl.innerHTML = `
            <div class="breaking-grid">
                ${breaking.map(n => this.breakingCard(n)).join('')}
            </div>`;

        // Grid: next batch
        const batchEnd = Math.min(2 + this.pageSize, filtered.length);
        this.displayedCount = batchEnd;
        const gridItems = filtered.slice(2, batchEnd);

        gridEl.innerHTML = gridItems.map(n => this.newsCard(n)).join('');

        loadWrap.style.display = this.displayedCount < filtered.length ? '' : 'none';
    },

    loadMore() {
        const filtered = this.getFiltered();
        const gridEl = document.getElementById('newsGrid');
        const loadWrap = document.getElementById('loadMoreWrap');

        const nextEnd = Math.min(this.displayedCount + this.pageSize, filtered.length);
        const newItems = filtered.slice(this.displayedCount, nextEnd);
        this.displayedCount = nextEnd;

        gridEl.innerHTML += newItems.map(n => this.newsCard(n)).join('');
        loadWrap.style.display = this.displayedCount < filtered.length ? '' : 'none';
    },

    breakingCard(n) {
        const isNew = (Date.now() - n.time) < 3600000; // < 1 hour
        const badge = isNew
            ? '<div class="breaking-badge"><span class="dot"></span>Son Dakika</div>'
            : '<div class="breaking-badge" style="background:rgba(37,99,235,0.12);color:var(--accent-blue)">Gündem</div>';
        return `
            <div class="breaking-card">
                <a href="${this.escAttr(n.url)}" target="_blank" rel="noopener">
                    <img class="breaking-img" src="${this.escAttr(n.image)}" alt="" loading="lazy"
                         onerror="this.style.display='none'">
                    <div class="breaking-content">
                        ${badge}
                        <h2 class="breaking-title">${this.esc(n.title)}</h2>
                        <p class="breaking-excerpt">${this.esc(n.body)}</p>
                        <div class="news-meta">
                            <span class="news-source">${this.esc(n.source)}</span>
                            <span class="news-meta-dot"></span>
                            <span class="news-time">${this.timeAgo(n.time)}</span>
                        </div>
                    </div>
                </a>
            </div>`;
    },

    newsCard(n) {
        const tagHTML = n.categories.slice(0, 2).map(c => {
            const cls = this.tagClass(c);
            return `<span class="news-tag ${cls}">${this.esc(this.catLabel(c))}</span>`;
        }).join('');
        return `
            <article class="news-card">
                <a href="${this.escAttr(n.url)}" target="_blank" rel="noopener">
                    <img class="news-img" src="${this.escAttr(n.image)}" alt="" loading="lazy"
                         onerror="this.style.background='var(--bg-elevated)';this.style.minHeight='80px';this.src='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'">
                    <div class="news-content">
                        <div class="news-meta">
                            <span class="news-source">${this.esc(n.source)}</span>
                            <span class="news-meta-dot"></span>
                            <span class="news-time">${this.timeAgo(n.time)}</span>
                        </div>
                        <h3 class="news-title">${this.esc(n.title)}</h3>
                        <div class="news-tags">${tagHTML}</div>
                    </div>
                </a>
            </article>`;
    },

    // ── Helpers ──
    timeAgo(ts) {
        const diff = Math.floor((Date.now() - ts) / 1000);
        if (diff < 60) return 'Az önce';
        if (diff < 3600) return Math.floor(diff / 60) + ' dk önce';
        if (diff < 86400) return Math.floor(diff / 3600) + ' saat önce';
        if (diff < 604800) return Math.floor(diff / 86400) + ' gün önce';
        return new Date(ts).toLocaleDateString('tr-TR');
    },

    tagClass(cat) {
        const map = { bitcoin: 'btc', altcoin: 'eth', emtia: 'defi', endeks: 'trading', forex: 'trading', ekonomi: 'regulation', regulasyon: 'regulation' };
        return map[cat] || '';
    },

    catLabel(cat) {
        const map = { bitcoin: 'Bitcoin', altcoin: 'Altcoin', emtia: 'Emtia', endeks: 'Endeksler', forex: 'Forex', ekonomi: 'Ekonomi', regulasyon: 'Regülasyon' };
        return map[cat] || cat;
    },

    esc(s) {
        if (!s) return '';
        const el = document.createElement('span');
        el.textContent = s;
        return el.innerHTML;
    },

    escAttr(s) {
        if (!s) return '';
        return s.replace(/"/g, '&quot;').replace(/'/g, '&#39;');
    },

    showLoading(show) {
        document.getElementById('loadingSpinner').style.display = show ? '' : 'none';
    },

    showError() {
        document.getElementById('newsGrid').innerHTML =
            '<div class="error-msg">Haberler yüklenirken bir hata oluştu. Lütfen sayfayı yenileyin.</div>';
    },

    setupFilters() {
        document.getElementById('categoryFilters').addEventListener('click', (e) => {
            const btn = e.target.closest('.cat-btn');
            if (!btn) return;
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            this.activeCategory = btn.dataset.cat;
            this.displayedCount = 0;
            this.render();
        });
    },

    setupLoadMore() {
        document.getElementById('loadMoreBtn').addEventListener('click', () => this.loadMore());
    }
};

NewsFeed.init();
    </script>
</body>
</html>
